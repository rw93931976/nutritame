<!DOCTYPE html>
<html>
<head>
    <title>Manual QA Test - v2.2.6-pending-resume-and-logs</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-step { margin: 20px 0; padding: 10px; border: 1px solid #ccc; border-radius: 5px; }
        .expected { background-color: #f0f8ff; }
        .console-log { background-color: #f5f5f5; font-family: monospace; padding: 5px; margin: 5px 0; }
        h2 { color: #0066cc; }
        h3 { color: #cc6600; }
    </style>
</head>
<body>
    <h1>Manual QA Test - v2.2.6-pending-resume-and-logs</h1>
    
    <h2>Test Instructions</h2>
    <p>Open Developer Console (F12) and navigate to <a href="http://localhost:3000/coach" target="_blank">http://localhost:3000/coach</a></p>
    
    <div class="test-step">
        <h3>Step 1: Clear localStorage and reload</h3>
        <p>In browser console, run:</p>
        <div class="console-log">
            localStorage.clear();<br>
            location.reload();
        </div>
    </div>
    
    <div class="test-step">
        <h3>Step 2: Type message and press Enter (pre-accept)</h3>
        <p>1. Type: <strong>create 3 day meal plan</strong></p>
        <p>2. Press Enter (DO NOT accept disclaimer yet)</p>
        <div class="expected">
            <strong>Expected Console Logs:</strong>
            <div class="console-log">
                [SEND ATTEMPT] stateAck=false lsAck=false accepted=false<br>
                [GATED: ack=false — no API call, no clearing]<br>
                [PENDING] stored question="create 3 day meal plan"
            </div>
            <p>Note: Disclaimer modal should appear</p>
        </div>
    </div>
    
    <div class="test-step">
        <h3>Step 3: Click Accept on Coach disclaimer</h3>
        <p>Click "Accept & Continue" button on the disclaimer modal</p>
        <div class="expected">
            <strong>Expected Console Logs:</strong>
            <div class="console-log">
                [ACK TRACE] BEFORE - stateAck=false lsAck=null<br>
                [ACK TRACE] AFTER - stateAck=true lsAck=true<br>
                [RESUME] auto-sending pending question="create 3 day meal plan"<br>
                [SEND ATTEMPT] stateAck=true lsAck=true accepted=true<br>
                [PROCEEDING] ack=true — calling backend<br>
                [COACH REQ] id=... start body="create 3 day meal plan"<br>
                [COACH RES] id=... status=200<br>
                [COACH RENDER] id=... count>=1<br>
                AI response found: 1
            </div>
            <p>Note: AI response should appear automatically without retyping</p>
        </div>
    </div>
    
    <h2>Success Criteria</h2>
    <ul>
        <li>✅ Auto-resume: Message sent automatically after Accept without retyping</li>
        <li>✅ Ack consistency: stateAck=true and lsAck=true after Accept</li>  
        <li>✅ Response handling: Full COACH REQ/RES/RENDER cycle visible</li>
        <li>✅ AI response renders in chat thread</li>
        <li>✅ Console noise: No Demo 404 loops, no Maps async warning, no long setTimeout</li>
    </ul>
    
    <h2>Noise Acceptance Criteria</h2>
    <ul>
        <li>✅ No Demo 404 loops during Coach flow</li>
        <li>✅ No Maps "loaded directly without loading=async" warning</li>
        <li>✅ No 'setTimeout' handler took XXms violations during first minute</li>
        <li>✅ Performance log: "[Perf] post-load tasks scheduled (no long setTimeout)"</li>
    </ul>
    
    <h2>Version Verification</h2>
    <p>Console should show: <code>[VERSION] v2.2.6-pending-resume-and-logs | commit=c0891a1</code></p>
</body>
</html>